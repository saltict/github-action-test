"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp=("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp||[]).push([[1308],{51308:(e,a,n)=>{n.r(a),n.d(a,{default:()=>S});var i=n(9661),s=n(54533),l=n(36926),r=n(56858),t=n(57801),d=n(75576),o=n(43557),c=n(73160),u=n(63910),m=n(12798),f=n(55204),h=n(92280),p=n(99656),g=n(72779),x=n.n(g),b=n(6746),w=n(58584),R=n(2784),k=n(76699),v=n(73557),j=n(82575),C=n(62197),_=n.n(C),y=n(95292),N=n(68774),W=n(94684),Z=n(13738),D=n(52322),E=function(e){return e.BOND_REWARD="bond-reward",e}(E||{});const S=(0,j.ZP)((e=>{const{className:a}=e,{chain:n,type:g}=(0,v.UO)(),j=g,C=(0,v.s0)(),S=(0,R.useContext)(d.R0),{asset:A,chain:B,from:I,onDone:O,setChain:T,setFrom:M}=(0,R.useContext)(Z.TransactionContext),{currentAccount:F,isAllAccount:L}=(0,o.v9)((e=>e.accountState)),{stakingRewardMap:X}=(0,o.v9)((e=>e.staking)),{chainInfoMap:H}=(0,o.v9)((e=>e.chainStore)),P=(0,o._y)(n,j),{decimals:Q,symbol:G}=(0,o.cR)(B),z=(0,R.useMemo)((()=>X.find((e=>e.chain===B&&e.address===I&&e.type===j))),[B,I,X,j]),K=(0,R.useMemo)((()=>X.filter((e=>e.chain===B&&e.type===j))),[B,X,j]),[V,q]=(0,R.useState)(!0),[U,$]=(0,R.useState)(!1),[J,Y]=(0,R.useState)(!0),[ee]=m.Z.useForm(),ae=(0,R.useMemo)((()=>({from:I,chain:B,asset:A,[E.BOND_REWARD]:!0})),[A,B,I]),{onError:ne,onSuccess:ie}=(0,o.Ls)(O),se=(0,R.useCallback)((()=>{C("/home/staking")}),[C]),le=(0,R.useCallback)(((e,a)=>{var n;const{error:i}=(0,u.ij)(a),s=(0,u.eW)(e),l=(0,u.eW)(a),{from:r}=s;void 0!==r&&M(r),q(i||!(null===(n=l.from)||void 0===n||n))}),[M]),{t:re}=(0,k.$)(),te=(0,R.useCallback)((e=>{$(!0);const{[E.BOND_REWARD]:a}=e;setTimeout((()=>{(0,c.QQq)({address:I,chain:B,bondReward:a,stakingType:j,unclaimedReward:null==z?void 0:z.unclaimedReward}).then(ie).catch(ne).finally((()=>{$(!1)}))}),300)}),[B,I,ne,ie,null==z?void 0:z.unclaimedReward,j]),de=(0,o.ve)(I),oe=(0,R.useCallback)((e=>{const a=n||"",t=H[a];if(!t)return!1;if(e.originGenesisHash&&(0,l.zb)(t)!==e.originGenesisHash)return!1;if((0,u.W_)(e.address))return!1;if(e.isReadOnly)return!1;if((0,l.h4)(t)!==(0,N.u)(e.address))return!1;const d=P.find((a=>(0,r.Wr)(a.address,e.address)));if(!d)return!1;const o=K.find((a=>(0,r.Wr)(a.address,e.address))),c=s.H_.astar.includes(a),m=s.H_.amplitude.includes(a),f=new(_())((null==o?void 0:o.unclaimedReward)||"0");return(j===i.WQ.POOLED||m)&&f.gt(y.nw)||c&&!!d.nominations.length}),[P,H,K,n,j]);return(0,R.useEffect)((()=>{const e=(null==F?void 0:F.address)||"";e&&((0,u.W_)(e)||M(e))}),[null==F?void 0:F.address,ee,M]),(0,R.useEffect)((()=>{T(n||"")}),[T,n]),(0,R.useEffect)((()=>{setTimeout((()=>{ee.validateFields().finally(u.ZT)}),500)}),[ee]),(0,D.jsxs)("div",{className:a,children:[(0,D.jsx)(W.tc,{children:(0,D.jsx)(t.FE,{resolve:S.awaitStores(["staking"]),children:(0,D.jsxs)(m.Z,{className:x()("form-container form-space-sm"),form:ee,initialValues:ae,onFieldsChange:le,onFinish:te,children:[(0,D.jsx)(m.Z.Item,{hidden:!L,name:"from",children:(0,D.jsx)(t.pK,{filter:oe})}),(0,D.jsx)(W.ZL,{address:I,chain:B,className:"free-balance",label:re("Available balance:"),onBalanceReady:Y}),(0,D.jsx)(m.Z.Item,{children:(0,D.jsxs)(t.oB,{className:"claim-reward-meta-info",hasBackgroundWrapper:!0,children:[(0,D.jsx)(t.oB.Chain,{chain:B,label:re("Network")}),(null==z?void 0:z.unclaimedReward)&&(0,D.jsx)(t.oB.Number,{decimals:Q,label:re("Reward claiming"),suffix:G,value:z.unclaimedReward})]})}),j===i.WQ.POOLED&&(0,D.jsx)(m.Z.Item,{name:E.BOND_REWARD,valuePropName:"checked",children:(0,D.jsx)(f.Z,{children:(0,D.jsx)("span",{className:"__option-label",children:re("Bond reward after claim")})})})]})})}),(0,D.jsxs)(W.Xd,{errors:[],warnings:[],children:[(0,D.jsx)(h.Z,{disabled:U,icon:(0,D.jsx)(p.Z,{phosphorIcon:b.Z,weight:"fill"}),onClick:se,schema:"secondary",children:re("Cancel")}),(0,D.jsx)(h.Z,{disabled:V||!J,icon:(0,D.jsx)(p.Z,{phosphorIcon:w.Z,weight:"fill"}),loading:U,onClick:de(ee.submit,i.Vv.STAKING_CLAIM_REWARD),children:re("Continue")})]})]})})).withConfig({displayName:"ClaimReward",componentId:"sc-1xc3rai-0"})((({theme:{token:e}})=>({flex:1,display:"flex",flexDirection:"column",".web-ui-enable &":{paddingTop:24,display:"block",maxWidth:416,width:"100%",marginLeft:"auto",marginRight:"auto",".transaction-footer":{paddingTop:4,gap:e.size}},".unstaked-field, .free-balance":{marginBottom:e.marginXS},".meta-info":{marginTop:e.paddingSM},".cancel-unstake-info-item > .__col":{flex:"initial",paddingRight:e.paddingXXS},".claim-reward-meta-info":{marginTop:e.marginXXS},".ant-checkbox-wrapper":{display:"flex",alignItems:"center",".ant-checkbox":{top:0}}})))}}]);