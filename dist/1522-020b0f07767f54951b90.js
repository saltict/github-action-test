"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp=("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp||[]).push([[1522],{71281:(e,t,n)=>{n.d(t,{Z:()=>u});var s=n(43905),i=n(80118),o=n(95023),a=n(72779),r=n.n(a),c=n(75720),l=(n(2784),n(76699)),d=n(87612),g=n(82575),m=n(52322);const u=(0,g.ZP)((e=>{const{accounts:t,className:n}=e,{t:a}=(0,l.$)();return(0,m.jsxs)("div",{className:r()(n),children:[(0,m.jsx)("div",{className:"page-icon",children:(0,m.jsx)(o.Z,{color:"var(--page-icon-color)",iconProps:{weight:"fill",phosphorIcon:c.Z}})}),(0,m.jsx)("div",{className:"title",children:a("All done!")}),(0,m.jsx)("div",{className:"description",children:a("You have successfully updated master password to all accounts")}),(0,m.jsxs)("div",{className:"account-container",children:[t.slice(0,2).map((e=>(0,m.jsx)(i.Z,{accountName:e.name,address:e.address,avatarSize:24,genesisHash:e.genesisHash,isSelected:!0},e.address))),t.length>2&&(0,m.jsx)("div",{className:"and-more",children:(0,m.jsx)(d.c,{components:{highlight:(0,m.jsx)("span",{className:"highlight"})},i18nKey:(0,s.T)("And other <highlight>{{number}}</highlight> accounts"),values:{number:String(t.length-2).padStart(2,"0")}})})]})]})})).withConfig({displayName:"Done__MigrateDone",componentId:"sc-1spq2zl-0"})((({theme:{token:e}})=>({textAlign:"center",".page-icon":{display:"flex",justifyContent:"center",marginTop:e.margin,marginBottom:e.margin,"--page-icon-color":e.colorSecondary},".title":{marginTop:e.margin,marginBottom:e.margin,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeHeading3,lineHeight:e.lineHeightHeading3,color:e.colorText},".description":{padding:`0 ${e.controlHeightLG-e.padding}px`,marginTop:e.margin,marginBottom:2*e.margin,fontSize:e.fontSizeHeading5,lineHeight:e.lineHeightHeading5,color:e.colorTextDescription,textAlign:"center"},".account-container":{display:"flex",flexDirection:"column",gap:e.sizeXS},".and-more":{fontSize:e.fontSizeHeading5,lineHeight:e.lineHeightHeading5,color:e.colorTextDescription,".highlight":{color:e.colorTextBase}}})))},71522:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var s=n(38014),i=n(57801),o=n(3612),a=n(43557),r=n(88528),c=n(73160),l=n(63910),d=n(99656),g=n(12798),m=n(19201),u=n(61882),h=n(92280),p=n(79100),f=n(72779),x=n.n(f),S=n(58584),w=n(75720),y=n(5373),j=n(2784),b=n(76699),H=n(35185),_=n(73557),v=n(82575),Z=n(71281),N=n(95023),I=n(70066),T=n(52322);const k=(0,v.ZP)((e=>{const{className:t}=e,{t:n}=(0,b.$)();return(0,T.jsxs)("div",{className:x()(t),children:[(0,T.jsx)("div",{className:"page-icon",children:(0,T.jsx)(N.Z,{color:"var(--page-icon-color)",iconProps:{weight:"fill",phosphorIcon:I.Z}})}),(0,T.jsx)("div",{className:"title",children:n("Apply master password")}),(0,T.jsx)("div",{className:"description",children:n("Master password created successfully. Please apply the master password to your existing accounts")})]})})).withConfig({displayName:"Introduction__IntroductionMigratePassword",componentId:"sc-1tlgtpi-0"})((({theme:{token:e}})=>({textAlign:"center",".page-icon":{display:"flex",justifyContent:"center","--page-icon-color":e.colorSecondary},".title":{marginTop:e.margin,marginBottom:e.margin,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeHeading3,lineHeight:e.lineHeightHeading3,color:e.colorText},".description":{padding:`0 ${e.controlHeightLG-e.padding}px`,fontSize:e.fontSizeHeading5,lineHeight:e.lineHeightHeading5,color:e.colorTextDescription,textAlign:"center"},".form-item-no-error":{".ant-form-item-explain":{display:"none"}}})));var A=function(e){return e.PASSWORD="password",e}(A||{});const C=(0,T.jsx)(d.Z,{phosphorIcon:S.Z,weight:"fill"}),M=(0,T.jsx)(d.Z,{phosphorIcon:w.Z,weight:"fill"}),D=(0,T.jsx)(d.Z,{phosphorIcon:y.Z}),B="migrate-password-form",P=`${B}_${A.PASSWORD}`,z=()=>{setTimeout((()=>{const e=document.getElementById(P);e&&e.select()}),10)},W=(0,v.ZP)((e=>{const{isWebUI:t}=(0,j.useContext)(o.sG),n=(0,_.s0)(),{className:d}=e,{t:f}=(0,b.$)(),{goHome:S}=(0,a.yu)(),w=(0,a.lm)(),{token:y}=(0,v.Fg)(),N=(0,a.ZR)(),{accounts:I}=(0,H.v9)((e=>e.accountState)),[W,F]=(0,j.useState)("Introduction"),[R]=g.Z.useForm(),[E,$]=(0,j.useState)(void 0),[O,L]=(0,j.useState)(!0),[G,X]=(0,j.useState)(!1),[q,V]=(0,j.useState)(!1),[K,U]=(0,j.useState)(!1),Y=(0,r.Z)(),J=(0,j.useRef)(I.filter((e=>e.address!==s.Tt&&!e.isExternal&&e.isMasterPassword))),Q=(0,j.useMemo)((()=>{const e=J.current,t=I.filter((e=>e.address!==s.Tt&&!e.isExternal&&e.isMasterPassword)),n=(i=t,e.filter((e=>i.find((t=>t.address===e.address)))));var i;return J.current=n,n}),[I]),ee=(0,j.useMemo)((()=>I.filter((e=>e.address!==s.Tt&&!e.isExternal)).filter((e=>!Q.find((t=>t.address===e.address))))),[I,Q]),te=(0,j.useMemo)((()=>ee.filter((e=>!e.isMasterPassword))),[ee]),ne=(0,j.useCallback)((()=>{"Migrate"===W?F("Introduction"):S()}),[S,W]),se=(0,j.useCallback)(((e,t)=>{const{empty:n,error:s}=(0,l.ij)(t);L(s||n)}),[]),ie=(0,j.useCallback)((e=>{const t=e[A.PASSWORD];null!=E&&E.address&&t&&(V(!0),setTimeout((()=>{(0,c.kTi)({address:E.address,password:t}).then((e=>{null!=e&&e.status?X(!1):(R.setFields([{name:A.PASSWORD,errors:[e.errors[0]]}]),z(),X(!0))})).catch((e=>{X(!0),R.setFields([{name:A.PASSWORD,errors:[e.message]}]),z()})).finally((()=>{V(!1)}))}),500))}),[null==E?void 0:E.address,R]),oe=(0,j.useMemo)((()=>{const e=ee.length-te.length;switch(W){case"Introduction":return f("Apply master password");case"Done":return f("Successful");case"Migrate":return`${String(e+1).padStart(2,"0")}/${String(ee.length).padStart(2,"0")}`;default:return""}}),[f,W,te.length,ee.length]),ae=(0,j.useMemo)((()=>{switch(W){case"Introduction":return{children:f("Apply master password now"),onClick:()=>{Y().then((()=>{t?te.length&&F("Migrate"):F(te.length?"Migrate":"Done")})).catch((()=>{}))},icon:C};case"Done":return{children:f("Finish"),onClick:()=>{S()},icon:M};case"Migrate":return{children:f("Next"),onClick:()=>{R.submit()},icon:C}}}),[Y,R,S,t,te.length,W,f]),re=(0,j.useCallback)((()=>{null!=E&&E.address&&N().then((()=>{U(!0),setTimeout((()=>{(0,c.a1d)(E.address).then((()=>{X(!1)})).catch((e=>{w({message:e.message,type:"error"})})).finally((()=>{U(!1)}))}),500)})).catch((e=>{e&&w({message:e.message,type:"error"})}))}),[null==E?void 0:E.address,N,w]);return(0,j.useEffect)((()=>{F((e=>"Introduction"!==e?t?te.length?"Migrate":e:te.length?"Migrate":"Done":"Introduction"))}),[te.length,K,t]),(0,j.useEffect)((()=>{"Migrate"===W?($((e=>{if(K)return e;if(e){const t=te.find((t=>t.address===e.address));return R.resetFields(),L(!0),t?e:te[0]}return R.resetFields(),L(!0),te[0]})),setTimeout((()=>{const e=document.getElementById(P);e&&e.focus()}),10)):(X(!1),R.resetFields(),L(!0))}),[R,te,K,W]),(0,j.useEffect)((()=>{"Introduction"!==W&&t&&!te.length&&n("/create-done",{state:{accounts:ee}})}),[t,n,ee,te.length,W]),(0,T.jsx)(i.FE,{animateOnce:!0,className:x()(d),children:(0,T.jsx)(i.Ar.Base,{...t?{}:{showBackButton:!0,subHeaderPaddingVertical:!0,showSubHeader:!0,subHeaderCenter:!0,subHeaderBackground:"transparent"},disableBack:q,onBack:ne,showBackButton:"Introduction"!==W,subHeaderLeft:"Done"===W&&(0,T.jsx)(i.Tw,{}),title:oe,children:(0,T.jsxs)("div",{className:x()("__screen-body",{"__web-ui":t}),children:["Introduction"===W&&(0,T.jsx)(k,{className:"__introduction-container"}),!t&&"Done"===W&&(0,T.jsx)(Z.Z,{accounts:ee,className:"__migrate-done-container"}),"Migrate"===W&&E&&(0,T.jsxs)("div",{className:"body-container",children:[(0,T.jsx)("div",{className:"account-avatar",children:(0,T.jsx)(p.Z,{size:4*y.sizeLG,theme:"ethereum"===E.type?"ethereum":"polkadot",value:E.address})}),(0,T.jsxs)(g.Z,{form:R,initialValues:{[A.PASSWORD]:""},name:B,onFieldsChange:se,onFinish:ie,children:[(0,T.jsx)(g.Z.Item,{children:(0,T.jsx)(m.Z,{content:E.name||"",label:f("Account name"),placeholder:f("Account name")})}),(0,T.jsx)(g.Z.Item,{children:(0,T.jsx)(m.Z,{content:(0,l.pC)(E.address||"",15,17),label:f("Account address"),placeholder:f("Account address")})}),(0,T.jsx)(g.Z.Item,{name:A.PASSWORD,rules:[{message:f("Current password is required"),required:!0}],statusHelpAsTooltip:!0,children:(0,T.jsx)(u.Z,{label:f("Current password"),type:"password"})}),G&&(0,T.jsx)(g.Z.Item,{className:"form-item-button",children:(0,T.jsx)(h.Z,{icon:D,loading:K,onClick:re,size:"xs",type:"ghost",children:f("Remove this account")})})]})]}),(0,T.jsx)(h.Z,{...ae,block:!0,className:"__footer-button",disabled:"Migrate"===W&&(O||K),loading:"Migrate"===W&&q})]})})})})).withConfig({displayName:"ApplyMasterPassword",componentId:"sc-dm26e8-0"})((({theme:{token:e}})=>({".__screen-body":{maxWidth:"416px",width:"100%",margin:"0 auto",paddingLeft:e.padding,paddingRight:e.padding},".body-container":{".account-avatar":{marginTop:e.margin,marginBottom:2*e.margin,display:"flex",flexDirection:"row",justifyContent:"center"},".ant-field-content-wrapper":{".ant-field-content":{color:e.colorTextDescription}},".ant-form-item":{marginBottom:e.marginXS},".form-item-no-error":{".ant-form-item-explain":{display:"none"}},".form-item-button":{paddingTop:e.marginXXS,marginBottom:0,".ant-form-item-control-input-content":{display:"flex",flexDirection:"row",justifyContent:"center"}}},".__screen-body.__web-ui":{".__introduction-container":{paddingBottom:e.padding},".__migrate-done-container":{paddingBottom:e.padding},".__footer-button":{marginTop:e.margin}}})))}}]);