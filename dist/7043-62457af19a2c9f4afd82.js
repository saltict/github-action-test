"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp=("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp||[]).push([[7043],{52274:(e,n,t)=>{t.d(n,{nC:()=>h,x1:()=>p.x1,b_:()=>p.b_,bO:()=>a});var s=t(80949),i=t(54533);const o="RMRK",r="SEND";function a(e,n){return e.type===s.Ym.ERC721?function(e){return{contractAddress:e.collectionId,tokenId:parseInt(e.id)}}(e):e.type===s.Ym.PSP34?function(e){return{contractAddress:e.collectionId,onChainOption:e.onChainOption,isPsp34:!0,networkKey:e.chain}}(e):i.r$.acala.includes(n)||i.r$.karura.includes(n)||i.r$.bitcountry.includes(n)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):i.r$.rmrk.includes(n)?function(e){return e.rmrk_ver?{remark:`${o}::${r}::${e.rmrk_ver}::${e.id}::`,networkKey:e.chain}:{}}(e):i.r$.statemine.includes(n)||i.r$.unique_network.includes(n)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):{}}var c=t(9661),l=t(36926),d=t(95110),u=t(63910),m=t(68774);const f=(e,n)=>t=>{const s=(0,m.u)(t.address),i=t.availableGenesisHashes||[];if(t.isHardware){if(s)return!1;if(n&&!i.includes((0,l.zb)(n)))return!1}return!((0,u.W_)(t.address)||t.isReadOnly||e===c.WQ.POOLED&&(0,m.u)(t.address))},h=(e,n,t)=>s=>{if(t&&t!==d.EN){const i=e[t],o=f(n,i),r=(0,l.h4)(i),a=(0,m.u)(s.address);return o(s)&&r===a}return f(n)(s)};var p=t(11164)},17043:(e,n,t)=>{t.r(n),t.d(n,{default:()=>$});var s=t(9661),i=t(56858),o=t(57801),r=t(89558),a=t(75576),c=t(43557),l=t(73160),d=t(63910),u=t(12798),m=t(79385),f=t(96562),h=t(92280),p=t(99656),w=t(72779),v=t.n(w),b=t(58584),k=t(2784),x=t(76699),I=t(73557),_=t(82575),g=t(61162),j=t(68774),y=t(52274),C=t(94684),N=t(13738),S=t(52322);const P={collectionId:"unknown",chain:"unknown"},D={collectionId:"unknown",chain:"unknown",owner:"unknown",id:"unknown"},Z=({modalContent:e=!1,nftDetail:n})=>{var t,a;const{t:w}=(0,x.$)(),_=(0,I.s0)(),Z=(0,I.UO)(),$=(null==n?void 0:n.chain)||Z.chain||"",A=(null==n?void 0:n.collectionId)||Z.collectionId||"",E=(null==n?void 0:n.id)||Z.itemId||"",F=(null==n?void 0:n.owner)||Z.owner||"",{chainInfoMap:T}=(0,c.v9)((e=>e.chainStore)),{nftCollections:R,nftItems:H}=(0,c.v9)((e=>e.nft)),{accounts:O}=(0,c.v9)((e=>e.accountState)),[K,M]=(0,k.useState)(!0),W=(0,k.useMemo)((()=>H.find((e=>(0,i.Wr)(e.owner,F)&&$===e.chain&&e.collectionId===A&&e.id===E))||D),[A,E,$,H,F]),L=(0,k.useMemo)((()=>R.find((e=>$===e.chain&&e.collectionId===A))||P),[A,$,R]),V=(0,k.useMemo)((()=>T[$]),[T,$]),Y=(0,c.xo)($),B=(null===(t=T[$])||void 0===t||null===(a=t.substrateInfo)||void 0===a?void 0:a.genesisHash)||"",{chain:G,from:U,onDone:q,setChain:z,setFrom:J}=(0,k.useContext)(N.TransactionContext),{onError:Q,onSuccess:X}=(0,c.Ls)(q),[ee]=u.Z.useForm(),ne=(0,k.useMemo)((()=>({from:U,chain:G,to:""})),[G,U]),[te,se]=(0,k.useState)(!0),[ie,oe]=(0,k.useState)(!1),re=(0,k.useCallback)((({getFieldValue:e})=>({validator:(e,n)=>{if(!n)return Promise.reject(w("The recipient address is required"));if(!(0,g.U)(n))return Promise.reject(w("Invalid recipient address"));if((0,i.Wr)(n,U))return Promise.reject(w("The recipient address can not be the same as the sender address"));if((0,j.u)(n)!==(0,j.u)(U)){const e=(0,j.u)(U)?w("Receive address must be of evm account."):w("Receive address must be of substrate account.");return Promise.reject(e)}const t=(0,d.Jd)(O,n);if(t&&t.isHardware){var s;const e=T[G],n=t.availableGenesisHashes||[];if(!(0,j.u)(t.address)&&!n.includes((null==e||null===(s=e.substrateInfo)||void 0===s?void 0:s.genesisHash)||"")){const n=(null==e?void 0:e.name)||"Unknown";return Promise.reject(w("Wrong network. Your Ledger account is not supported by {{network}}. Please choose another receiving account and try again.",{replace:{network:n}}))}}return Promise.resolve()}})),[U,O,w,T,G]),ae=(0,k.useCallback)(((e,n)=>{const{error:t}=(0,d.ij)(n);se(t)}),[]),ce=(0,k.useCallback)((e=>{const n=(0,j.u)(U),{to:t}=e,s=(0,y.bO)(W,G);let i;i=n?(0,l.Y54)({senderAddress:U,networkKey:G,recipientAddress:t,nftItemName:null==W?void 0:W.name,params:s,nftItem:W}):(0,l.QxE)({networkKey:G,recipientAddress:t,senderAddress:U,nftItemName:null==W?void 0:W.name,params:s,nftItem:W}),oe(!0),setTimeout((()=>{i.then(X).catch(Q).finally((()=>{oe(!1)}))}),300)}),[G,U,W,Q,X]),le=(0,c.ve)(U);(0,k.useEffect)((()=>{z($),J(F)}),[$,F,z,J]),(0,k.useEffect)((()=>{W!==D&&L!==P||_("/home/nfts/collections")}),[L,_,W]),(0,c.uy)(ee,"to");const de=r._s.includes(W.chain);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(C.tc,{className:v()("-transaction-content",{"__web-content":e}),children:[(0,S.jsxs)("div",{className:v()("nft_item_detail text-center",{"__modal-ui":e}),children:[(0,S.jsx)(m.Z,{height:e?180:120,modelViewerProps:de?r.iz:void 0,src:W.image,width:e?180:120}),(0,S.jsx)(f.Z.Title,{level:5,children:W.name})]}),(0,S.jsxs)(u.Z,{className:v()("form-container form-space-sm",{"__modal-ui":e}),form:ee,initialValues:ne,onFieldsChange:ae,onFinish:ce,children:[(0,S.jsx)(u.Z.Item,{name:"to",rules:[re],statusHelpAsTooltip:!0,children:(0,S.jsx)(o.Jg,{addressPrefix:Y,allowDomain:!0,chain:G,label:w("Send to"),networkGenesisHash:B,placeholder:w("Account address"),saveAddress:!0,showAddressBook:!0,showScanner:!0})}),(0,S.jsx)(u.Z.Item,{children:(0,S.jsx)(o.oT,{disabled:!0,items:V?[{name:V.name,slug:V.slug}]:[],label:w("Network"),value:L.chain})})]}),(0,S.jsx)(C.ZL,{address:U,chain:G,label:w("Sender transferable balance")+":",onBalanceReady:M})]}),(0,S.jsx)(C.Xd,{className:v()("send-nft-transaction-footer",{"__modal-ui":e}),errors:[],warnings:[],children:(0,S.jsx)(h.Z,{disabled:te||!K,icon:(0,S.jsx)(p.Z,{phosphorIcon:b.Z,weight:"fill"}),loading:ie,onClick:le(ee.submit,s.Vv.SEND_NFT),children:w("Next")})})]})},$=(0,_.ZP)((e=>{const{className:n}=e,t=(0,k.useContext)(a.R0);return(0,S.jsx)(o.FE,{className:n,resolve:t.awaitStores(["nft"]),children:(0,S.jsx)(Z,{modalContent:e.modalContent,nftDetail:e.nftDetail})})})).withConfig({displayName:"SendNFT",componentId:"sc-13wb87a-0"})((({theme:{token:e}})=>({flex:1,display:"flex",flexDirection:"column",overflow:"hidden",".__web-content":{padding:0},".nft_item_detail h5":{marginTop:e.marginXS,marginBottom:e.margin},".__modal-ui":{padding:0,"&.transaction-footer":{margin:0,".ant-btn":{margin:"32px 0 0"}},"&.form-container":{display:"flex",flexDirection:"column-reverse"},"&.send-nft-transaction-footer":{"& > .ant-btn":{width:"100%"}},"&.nft_item_detail":{img:{aspectRatio:"1"}}},".nft_item_detail":{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",".ant-image-img":{maxWidth:"100%",objectFit:"cover"}}})))}}]);