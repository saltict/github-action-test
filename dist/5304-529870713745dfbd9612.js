"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp=("undefined"!=typeof self?self:this).webpackChunk_subwallet_webapp||[]).push([[5304,7043],{15304:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var i=n(6723),o=n(57801),a=n(32204),l=n(89558),r=n(75576),s=n(3612),d=n(43557),c=n(4517),_=n(43246),f=n(47088),m=n(71871),u=n(51952),p=n(63910),h=n(48685),g=n(99656),x=n(12162),w=n(66611),b=n(79385),v=n(92280),j=n(19201),k=n(58094),I=n(79100),S=n(14546),y=n(72779),C=n.n(y),N=n(28394),Z=n(78166),T=n(62982),z=n(2784),D=n(35185),H=n(73557),L=n(82575),F=n(68774),B=n(13738),P=n(17043),W=n(52322);const $="transfer-nft-modal",R=(0,W.jsx)(g.Z,{customSize:"24px",phosphorIcon:N.Z,type:"phosphor",weight:"light"}),M=(0,L.ZP)((function({className:e=""}){var t,n,y;const N=(0,H.TH)(),[M]=(0,z.useState)(null===(t=N.state)||void 0===t?void 0:t.collectionInfo),[G]=(0,z.useState)(null===(n=N.state)||void 0===n?void 0:n.nftItem),X=(0,H.bx)(),A=null==X?void 0:X.setDetailTitle,{isWebUI:E}=(0,z.useContext)(s.sG),{t:O}=(0,_.Z)(),U=(0,c.Z)(),K=(0,H.s0)(),{goBack:V}=(0,f.Z)(),{token:Y}=(0,L.Fg)(),Q=(0,z.useContext)(r.R0),{activeModal:q,inactiveModal:J}=(0,z.useContext)(x.t),ee=(0,D.v9)((e=>e.accountState.accounts)),te=(0,m.Z)(G.chain),ne=(0,u.Z)(G.owner||""),ie=(0,i.E)(te,G.owner,"account"),[oe,ae]=(0,z.useState)("sendNftKey");(0,d.qg)("/home/nfts/collections");const le=(0,z.useCallback)((()=>{if(G&&G.owner){const e=(0,h.Z)(G.owner,42),t=ee.find((t=>t.address===e));if(null!=t&&t.isReadOnly)return void U({message:O("The NFT owner is a watch-only account, you cannot send the NFT with it"),type:"info",duration:3})}E?q($):K(`/transaction/send-nft/${G.owner}/${G.chain}/${G.collectionId}/${G.id}`)}),[ee,K,G,E,q,U,O]),re=[{children:O("Send"),onClick:le}],se=(0,z.useCallback)((()=>{if(G.owner){var e;const t=(0,F.u)(G.owner)?"ethereum":"polkadot";return(0,W.jsx)(I.Z,{identPrefix:null===(e=te.substrateInfo)||void 0===e?void 0:e.addressPrefix,size:Y.fontSizeXL,theme:t,value:G.owner})}return(0,W.jsx)("div",{})}),[G.owner,null===(y=te.substrateInfo)||void 0===y?void 0:y.addressPrefix,Y.fontSizeXL]),de=(0,z.useCallback)((()=>(0,W.jsx)(w.Z,{network:te.slug,shape:"circle",size:Y.fontSizeXL})),[te.slug,Y.fontSizeXL]),ce=(0,z.useCallback)((()=>(0,W.jsxs)("span",{children:[(0,W.jsx)("span",{children:null==ne?void 0:ne.name})," ",(0,W.jsxs)("span",{className:"nft_item_detail__owner_address",children:["(",`${null==G?void 0:G.owner.slice(0,4)}...${null==G?void 0:G.owner.slice(-4)}`,")"]})]})),[null==G?void 0:G.owner,null==ne?void 0:ne.name]),_e=(0,z.useCallback)((()=>{try{ie?(0,p.YQ)(ie)():console.log("error redirecting to a new tab")}catch(e){console.log("error redirecting to a new tab")}}),[ie]),fe=(0,z.useCallback)((()=>{try{G.externalUrl?(0,p.YQ)(G.externalUrl)():console.log("error redirecting to a new tab")}catch(e){console.log("error redirecting to a new tab")}}),[G.externalUrl]),me=(0,z.useCallback)((e=>(0,W.jsx)("div",{className:"nft_item_detail__external_icon",onClick:"account"===e?_e:fe,children:(0,W.jsx)(g.Z,{customSize:"20px",phosphorIcon:Z.Z,type:"phosphor",weight:"light"})})),[_e,fe]),ue=(0,z.useCallback)((()=>{null!=G&&G.description&&G.description.length>70&&q("nftItemDescription")}),[q,G.description]),pe=(0,z.useCallback)((()=>{J("nftItemDescription")}),[J]),he=(0,z.useCallback)((()=>{G.externalUrl&&chrome.tabs.create({url:G.externalUrl,active:!0}).then((()=>console.log("redirecting"))).catch(console.error)}),[G.externalUrl]);(0,z.useEffect)((()=>{null==A||A(G.name||G.id)}),[G,A]);const ge=(0,z.useCallback)((()=>{J($),ae(`sendNftKey-${Date.now()}`)}),[J]),xe=l._s.includes(G.chain),we=E?384:358;return(0,W.jsx)(o.FE,{className:`${e}`,resolve:Q.awaitStores(["nft","accountState","chainStore"]),children:(0,W.jsxs)(o.Ar.Base,{...!E&&{onBack:V,showBackButton:!0,showSubHeader:!0,subHeaderBackground:"transparent",subHeaderCenter:!1,subHeaderIcons:re,subHeaderPaddingVertical:!0,title:G.name||G.id},children:[(0,W.jsxs)("div",{className:"nft_item_detail__container",children:[(0,W.jsxs)("div",{className:"nft_item_detail__nft_image",children:[(0,W.jsx)(b.Z,{className:C()({clickable:G.externalUrl}),height:we,modelViewerProps:xe?{...l.iz,...l.hi}:void 0,onClick:he,src:G.image,width:xe?we:void 0}),E&&(0,W.jsx)(v.Z,{block:!0,icon:(0,W.jsx)(g.Z,{phosphorIcon:T.Z,type:"phosphor",weight:"fill"}),onClick:le,children:(0,W.jsx)("span",{className:"nft_item_detail__send_text",children:"Send"})})]}),(0,W.jsxs)("div",{className:"nft_item_detail_field_container",children:[(0,W.jsxs)("div",{className:"nft_item_detail__info_container",children:[!E&&(0,W.jsx)("div",{className:"nft_item_detail__section_title",children:O("NFT details")}),E&&!!G.description&&(0,W.jsx)("div",{className:"nft_item_detail__description",children:G.description}),!E&&!!G.description&&(0,W.jsxs)("div",{className:"nft_item_detail__description_container",onClick:ue,style:{cursor:G.description.length>70?"pointer":"auto"},children:[(0,W.jsx)("div",{className:"nft_item_detail__description_content",children:G.description.length>70?`${G.description.slice(0,70)}...`:G.description}),(0,W.jsxs)("div",{className:"nft_item_detail__description_title",children:[(0,W.jsx)(g.Z,{iconColor:Y.colorIcon,phosphorIcon:Z.Z,type:"phosphor",weight:"fill"}),(0,W.jsx)("div",{children:O("Description")})]})]}),(0,W.jsxs)("div",{className:"nft_item_detail__info_field_container",children:[(0,W.jsx)(j.Z,{content:M.collectionName||M.collectionId,label:O("NFT collection name"),suffix:G.externalUrl&&me("collection")}),(0,W.jsx)(j.Z,{content:ce(),label:O("Owned by"),prefix:G.owner&&se(),suffix:me("account")}),(0,W.jsx)(j.Z,{content:te.name,label:O("Network"),prefix:de()})]})]}),(0,W.jsxs)("div",{className:"nft_item_detail__prop_section",children:[(0,W.jsx)("div",{className:"nft_item_detail__section_title",children:O("Properties")}),(0,W.jsxs)("div",{className:"nft_item_detail__atts_container",children:[(0,W.jsx)(j.Z,{className:"nft_item_detail__id_field",content:G.id,label:"NFT ID",width:"fit-content"},"NFT ID"),(0,W.jsx)(j.Z,{className:"nft_item_detail__id_field",content:G.collectionId,label:"Collection ID",width:"fit-content"},"Collection ID"),G.properties&&Object.entries(G.properties).map((([e,t],n)=>{const{value:i}=t;return(0,W.jsx)(j.Z,{content:i.toString(),label:e,width:"fit-content"},n)}))]})]})]}),!E&&(0,W.jsx)(v.Z,{block:!0,icon:(0,W.jsx)(g.Z,{phosphorIcon:T.Z,type:"phosphor",weight:"fill"}),onClick:le,children:(0,W.jsx)("span",{className:"nft_item_detail__send_text",children:O("Send")})})]}),(0,W.jsx)(a.I,{id:$,onCancel:ge,title:O("Transfer"),children:(0,W.jsx)(B.default,{modalContent:!0,children:(0,W.jsx)(P.default,{modalContent:!0,nftDetail:G})},oe)}),(0,W.jsx)(a.I,{className:C()("nft_item_detail__description_modal"),closeIcon:R,id:"nftItemDescription",onCancel:pe,title:O("Description"),wrapClassName:e,children:(0,W.jsxs)("div",{className:"nft_item_detail__description_modal_content",children:[(0,W.jsx)("div",{className:"nft_item_detail__description_modal_left_icon",children:(0,W.jsx)(k.Z,{backgroundColor:(0,S.If)(Y.colorLink,.1),iconColor:Y.colorLink,phosphorIcon:Z.Z,size:"lg",type:"phosphor",weight:"fill"})}),(0,W.jsxs)("div",{className:"nft_item_detail_description_modal_container",children:[(0,W.jsx)("div",{className:"nft_item_detail__description_modal_title",children:G.name||G.id}),(0,W.jsx)("div",{className:"nft_item_detail__description_modal_detail",children:(0,W.jsx)("pre",{children:G.description})})]})]})})]})})})).withConfig({displayName:"NftItemDetail",componentId:"sc-1ffl3tk-0"})((({theme:{token:e}})=>({".nft_item_detail__container":{marginTop:e.marginSM,paddingRight:e.margin,paddingLeft:e.margin,paddingBottom:e.margin},".clickable":{cursor:"pointer"},".nft_item_detail__info_container":{display:"flex",flexDirection:"column",gap:e.marginXS,marginTop:e.margin,marginBottom:e.margin},".nft_item_detail__atts_container":{marginTop:e.margin,display:"flex",flexWrap:"wrap",gap:e.marginXS,overflow:"hidden"},".ant-field-container":{overflow:"hidden"},".nft_item_detail__section_title":{fontSize:e.fontSizeLG,color:e.colorTextHeading,lineHeight:e.lineHeightLG},".nft_item_detail__send_text":{fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG,color:e.colorTextLight1},".nft_item_detail__prop_section":{marginBottom:e.margin},".nft_item_detail__owner_address":{color:e.colorTextDescription},".nft_item_detail__external_icon":{cursor:"pointer"},".nft_item_detail__description_container":{padding:e.paddingSM,backgroundColor:e.colorBgSecondary,borderRadius:e.borderRadiusLG},".nft_item_detail__description_content":{color:e.colorTextDescription,fontSize:e.fontSize,fontWeight:e.bodyFontWeight,lineHeight:e.lineHeight,wordBreak:"break-all"},".nft_item_detail__description_title":{marginTop:e.margin,display:"flex",alignItems:"center",gap:e.marginXXS,color:e.colorTextLabel,fontSize:e.fontSize,fontWeight:e.headingFontWeight,lineHeight:e.lineHeight},".nft_item_detail__description_modal_content":{display:"flex",gap:e.marginXS,padding:e.paddingSM,backgroundColor:e.colorBgSecondary,borderRadius:e.borderRadiusLG},".nft_item_detail__description_modal_left_icon":{display:"flex",alignItems:"center"},".nft_item_detail__description_modal_title":{textAlign:"left",fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG,fontWeight:e.bodyFontWeight,color:e.colorTextLight1,wordBreak:"break-all"},".nft_item_detail__description_modal_detail":{textAlign:"justify",fontWeight:e.bodyFontWeight,fontSize:e.fontSizeHeading6,color:e.colorTextTertiary,wordBreak:"break-word"},".nft_item_detail__nft_image":{display:"flex",justifyContent:"center",width:"100%",".ant-image-img":{maxWidth:"100%",objectFit:"cover"}},".nft_item_detail__id_field .ant-field-wrapper .ant-field-content-wrapper .ant-field-content":{overflow:"auto",textOverflow:"initial"},".nft_item_detail__info_field_container":{display:"flex",flexDirection:"column",gap:e.sizeXS},".web-ui-enable &":{".nft_item_detail__container":{marginTop:0,padding:0,display:"flex",gap:e.size,flexWrap:"wrap",justifyContent:"center"},".nft_item_detail__nft_image":{display:"flex",flexDirection:"column",flexBasis:384,maxWidth:384,gap:e.size,alignItems:"center",justifyContent:"flex-start"},".nft_item_detail_field_container":{flexGrow:1,flexBasis:500},".nft_item_detail__description":{backgroundColor:e.colorBgSecondary,padding:e.paddingSM,borderRadius:e.borderRadiusLG,color:e.colorTextLight4,fontSize:e.fontSize,lineHeight:e.lineHeight},".nft_item_detail__info_container":{marginTop:0,gap:e.size},".nft_item_detail__info_field_container":{flexWrap:"wrap",flexDirection:"row",gap:e.size},".nft_item_detail__info_field_container .ant-field-container":{flexBasis:"calc(50% - 8px)"},".nft_item_detail__atts_container":{gap:e.sizeSM,".ant-field-container .ant-field-label":{paddingTop:e.paddingSM,top:0},".ant-field-container .ant-field-wrapper":{paddingTop:e.paddingXXS,paddingBottom:e.paddingSM,minHeight:0}}}})))},52274:(e,t,n)=>{n.d(t,{nC:()=>u,x1:()=>p.x1,b_:()=>p.b_,bO:()=>r});var i=n(80949),o=n(54533);const a="RMRK",l="SEND";function r(e,t){return e.type===i.Ym.ERC721?function(e){return{contractAddress:e.collectionId,tokenId:parseInt(e.id)}}(e):e.type===i.Ym.PSP34?function(e){return{contractAddress:e.collectionId,onChainOption:e.onChainOption,isPsp34:!0,networkKey:e.chain}}(e):o.r$.acala.includes(t)||o.r$.karura.includes(t)||o.r$.bitcountry.includes(t)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):o.r$.rmrk.includes(t)?function(e){return e.rmrk_ver?{remark:`${a}::${l}::${e.rmrk_ver}::${e.id}::`,networkKey:e.chain}:{}}(e):o.r$.statemine.includes(t)||o.r$.unique_network.includes(t)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):{}}var s=n(9661),d=n(36926),c=n(95110),_=n(63910),f=n(68774);const m=(e,t)=>n=>{const i=(0,f.u)(n.address),o=n.availableGenesisHashes||[];if(n.isHardware){if(i)return!1;if(t&&!o.includes((0,d.zb)(t)))return!1}return!((0,_.W_)(n.address)||n.isReadOnly||e===s.WQ.POOLED&&(0,f.u)(n.address))},u=(e,t,n)=>i=>{if(n&&n!==c.EN){const o=e[n],a=m(t,o),l=(0,d.h4)(o),r=(0,f.u)(i.address);return a(i)&&l===r}return m(t)(i)};var p=n(11164)},17043:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var i=n(9661),o=n(56858),a=n(57801),l=n(89558),r=n(75576),s=n(43557),d=n(73160),c=n(63910),_=n(12798),f=n(79385),m=n(96562),u=n(92280),p=n(99656),h=n(72779),g=n.n(h),x=n(58584),w=n(2784),b=n(76699),v=n(73557),j=n(82575),k=n(61162),I=n(68774),S=n(52274),y=n(94684),C=n(13738),N=n(52322);const Z={collectionId:"unknown",chain:"unknown"},T={collectionId:"unknown",chain:"unknown",owner:"unknown",id:"unknown"},z=({modalContent:e=!1,nftDetail:t})=>{var n,r;const{t:h}=(0,b.$)(),j=(0,v.s0)(),z=(0,v.UO)(),D=(null==t?void 0:t.chain)||z.chain||"",H=(null==t?void 0:t.collectionId)||z.collectionId||"",L=(null==t?void 0:t.id)||z.itemId||"",F=(null==t?void 0:t.owner)||z.owner||"",{chainInfoMap:B}=(0,s.v9)((e=>e.chainStore)),{nftCollections:P,nftItems:W}=(0,s.v9)((e=>e.nft)),{accounts:$}=(0,s.v9)((e=>e.accountState)),[R,M]=(0,w.useState)(!0),G=(0,w.useMemo)((()=>W.find((e=>(0,o.Wr)(e.owner,F)&&D===e.chain&&e.collectionId===H&&e.id===L))||T),[H,L,D,W,F]),X=(0,w.useMemo)((()=>P.find((e=>D===e.chain&&e.collectionId===H))||Z),[H,D,P]),A=(0,w.useMemo)((()=>B[D]),[B,D]),E=(0,s.xo)(D),O=(null===(n=B[D])||void 0===n||null===(r=n.substrateInfo)||void 0===r?void 0:r.genesisHash)||"",{chain:U,from:K,onDone:V,setChain:Y,setFrom:Q}=(0,w.useContext)(C.TransactionContext),{onError:q,onSuccess:J}=(0,s.Ls)(V),[ee]=_.Z.useForm(),te=(0,w.useMemo)((()=>({from:K,chain:U,to:""})),[U,K]),[ne,ie]=(0,w.useState)(!0),[oe,ae]=(0,w.useState)(!1),le=(0,w.useCallback)((({getFieldValue:e})=>({validator:(e,t)=>{if(!t)return Promise.reject(h("The recipient address is required"));if(!(0,k.U)(t))return Promise.reject(h("Invalid recipient address"));if((0,o.Wr)(t,K))return Promise.reject(h("The recipient address can not be the same as the sender address"));if((0,I.u)(t)!==(0,I.u)(K)){const e=(0,I.u)(K)?h("Receive address must be of evm account."):h("Receive address must be of substrate account.");return Promise.reject(e)}const n=(0,c.Jd)($,t);if(n&&n.isHardware){var i;const e=B[U],t=n.availableGenesisHashes||[];if(!(0,I.u)(n.address)&&!t.includes((null==e||null===(i=e.substrateInfo)||void 0===i?void 0:i.genesisHash)||"")){const t=(null==e?void 0:e.name)||"Unknown";return Promise.reject(h("Wrong network. Your Ledger account is not supported by {{network}}. Please choose another receiving account and try again.",{replace:{network:t}}))}}return Promise.resolve()}})),[K,$,h,B,U]),re=(0,w.useCallback)(((e,t)=>{const{error:n}=(0,c.ij)(t);ie(n)}),[]),se=(0,w.useCallback)((e=>{const t=(0,I.u)(K),{to:n}=e,i=(0,S.bO)(G,U);let o;o=t?(0,d.Y54)({senderAddress:K,networkKey:U,recipientAddress:n,nftItemName:null==G?void 0:G.name,params:i,nftItem:G}):(0,d.QxE)({networkKey:U,recipientAddress:n,senderAddress:K,nftItemName:null==G?void 0:G.name,params:i,nftItem:G}),ae(!0),setTimeout((()=>{o.then(J).catch(q).finally((()=>{ae(!1)}))}),300)}),[U,K,G,q,J]),de=(0,s.ve)(K);(0,w.useEffect)((()=>{Y(D),Q(F)}),[D,F,Y,Q]),(0,w.useEffect)((()=>{G!==T&&X!==Z||j("/home/nfts/collections")}),[X,j,G]),(0,s.uy)(ee,"to");const ce=l._s.includes(G.chain);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(y.tc,{className:g()("-transaction-content",{"__web-content":e}),children:[(0,N.jsxs)("div",{className:g()("nft_item_detail text-center",{"__modal-ui":e}),children:[(0,N.jsx)(f.Z,{height:e?180:120,modelViewerProps:ce?l.iz:void 0,src:G.image,width:e?180:120}),(0,N.jsx)(m.Z.Title,{level:5,children:G.name})]}),(0,N.jsxs)(_.Z,{className:g()("form-container form-space-sm",{"__modal-ui":e}),form:ee,initialValues:te,onFieldsChange:re,onFinish:se,children:[(0,N.jsx)(_.Z.Item,{name:"to",rules:[le],statusHelpAsTooltip:!0,children:(0,N.jsx)(a.Jg,{addressPrefix:E,allowDomain:!0,chain:U,label:h("Send to"),networkGenesisHash:O,placeholder:h("Account address"),saveAddress:!0,showAddressBook:!0,showScanner:!0})}),(0,N.jsx)(_.Z.Item,{children:(0,N.jsx)(a.oT,{disabled:!0,items:A?[{name:A.name,slug:A.slug}]:[],label:h("Network"),value:X.chain})})]}),(0,N.jsx)(y.ZL,{address:K,chain:U,label:h("Sender transferable balance")+":",onBalanceReady:M})]}),(0,N.jsx)(y.Xd,{className:g()("send-nft-transaction-footer",{"__modal-ui":e}),errors:[],warnings:[],children:(0,N.jsx)(u.Z,{disabled:ne||!R,icon:(0,N.jsx)(p.Z,{phosphorIcon:x.Z,weight:"fill"}),loading:oe,onClick:de(ee.submit,i.Vv.SEND_NFT),children:h("Next")})})]})},D=(0,j.ZP)((e=>{const{className:t}=e,n=(0,w.useContext)(r.R0);return(0,N.jsx)(a.FE,{className:t,resolve:n.awaitStores(["nft"]),children:(0,N.jsx)(z,{modalContent:e.modalContent,nftDetail:e.nftDetail})})})).withConfig({displayName:"SendNFT",componentId:"sc-13wb87a-0"})((({theme:{token:e}})=>({flex:1,display:"flex",flexDirection:"column",overflow:"hidden",".__web-content":{padding:0},".nft_item_detail h5":{marginTop:e.marginXS,marginBottom:e.margin},".__modal-ui":{padding:0,"&.transaction-footer":{margin:0,".ant-btn":{margin:"32px 0 0"}},"&.form-container":{display:"flex",flexDirection:"column-reverse"},"&.send-nft-transaction-footer":{"& > .ant-btn":{width:"100%"}},"&.nft_item_detail":{img:{aspectRatio:"1"}}},".nft_item_detail":{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",".ant-image-img":{maxWidth:"100%",objectFit:"cover"}}})))}}]);